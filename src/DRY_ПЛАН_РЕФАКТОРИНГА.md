# üîß –ü–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ DRY

## –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∫–æ–¥–∞

---

## üöÄ –§–ê–ó–ê 1: –ë—ã—Å—Ç—Ä—ã–µ –ø–æ–±–µ–¥—ã (2-3 —á–∞—Å–∞)

### –ó–∞–¥–∞—á–∞ 1.1: –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (1.5 —á–∞—Å–∞)

#### –î–µ–π—Å—Ç–≤–∏–µ 1: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (9 —Ñ–∞–π–ª–æ–≤ ‚Üí 2 —Ñ–∞–π–ª–∞)

**–£–¥–∞–ª–∏—Ç—å:**
```bash
rm –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨_–û–ë–ù–û–í–õ–ï–ù–û.md
rm –ì–û–¢–û–í–û_–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨.md
rm –ò–¢–û–ì–û_–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨.md
rm –î–ê_–ì–û–¢–û–í–û.md
rm –ë–´–°–¢–†–´–ô_–°–¢–ê–†–¢_–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨.md
rm –®–ü–ê–†–ì–ê–õ–ö–ê_–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨.md
rm –¢–ï–°–¢_–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò.md
rm –ß–ï–ö–õ–ò–°–¢_–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨.md
rm –°–•–ï–ú–ê_–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò.md
```

**–°–æ–∑–¥–∞—Ç—å:** `docs/SECURITY.md` (—É–∂–µ –µ—Å—Ç—å, –¥–æ–ø–æ–ª–Ω–∏—Ç—å)

**–°–æ–∑–¥–∞—Ç—å:** `docs/SECURITY_QUICKSTART.md`
```markdown
# –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ
1. UTF-8 –∏ –∫–∏—Ä–∏–ª–ª–∏—Ü–∞ ‚úÖ
2. Rate Limiting ‚úÖ
3. XSS –∑–∞—â–∏—Ç–∞ ‚úÖ

## –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
[–ö—Ä–∞—Ç–∫–∏–π —á–µ–∫–ª–∏—Å—Ç –∏–∑ –≤—Å–µ—Ö 9 —Ñ–∞–π–ª–æ–≤]

## –ö–æ–º–∞–Ω–¥—ã
[–®–ø–∞—Ä–≥–∞–ª–∫–∞ –∏–∑ –≤—Å–µ—Ö 9 —Ñ–∞–π–ª–æ–≤]
```

#### –î–µ–π—Å—Ç–≤–∏–µ 2: –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (4 —Ñ–∞–π–ª–∞ ‚Üí 1 —Ñ–∞–π–ª)

**–£–¥–∞–ª–∏—Ç—å:**
```bash
rm –ò–ù–°–¢–†–£–ö–¶–ò–Ø_–î–õ–Ø_–ù–û–í–ò–ß–ö–û–í.md
rm –ò–ù–°–¢–†–£–ö–¶–ò–Ø_–î–õ–Ø_–ü–ï–†–í–û–ì–û_–†–ê–ó–ê.md
rm –ù–ê–ß–ù–ò–¢–ï_–ó–î–ï–°–¨.md
rm –°–î–ï–õ–ê–ô–¢–ï_–≠–¢–û_–°–ï–ô–ß–ê–°.md
```

**–°–æ–∑–¥–∞—Ç—å:** `docs/GETTING_STARTED.md`
```markdown
# –° —á–µ–≥–æ –Ω–∞—á–∞—Ç—å

## –î–ª—è –Ω–æ–≤–∏—á–∫–æ–≤
[–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ò–ù–°–¢–†–£–ö–¶–ò–Ø_–î–õ–Ø_–ù–û–í–ò–ß–ö–û–í]

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
[–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –°–î–ï–õ–ê–ô–¢–ï_–≠–¢–û_–°–ï–ô–ß–ê–°]

## –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
[–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ù–ê–ß–ù–ò–¢–ï_–ó–î–ï–°–¨]
```

#### –î–µ–π—Å—Ç–≤–∏–µ 3: –ß–µ–∫–ª–∏—Å—Ç—ã (4 —Ñ–∞–π–ª–∞ ‚Üí 1 —Ñ–∞–π–ª)

**–£–¥–∞–ª–∏—Ç—å:**
```bash
rm CHECKLIST.md
rm –ß–ï–ö–õ–ò–°–¢_–ó–ê–ü–£–°–ö–ê.md
rm PRODUCTION_CHECKLIST.md
# –ß–ï–ö–õ–ò–°–¢_–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨.md —É–∂–µ —É–¥–∞–ª–µ–Ω –≤—ã—à–µ
```

**–°–æ–∑–¥–∞—Ç—å:** `docs/CHECKLISTS.md`
```markdown
# –ß–µ–∫–ª–∏—Å—Ç—ã

## –ß–µ–∫–ª–∏—Å—Ç –∑–∞–ø—É—Å–∫–∞
[...]

## Production —á–µ–∫–ª–∏—Å—Ç
[...]

## –ß–µ–∫–ª–∏—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
[...]
```

#### –î–µ–π—Å—Ç–≤–∏–µ 4: –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π (5+ —Ñ–∞–π–ª–æ–≤ ‚Üí 1 —Ñ–∞–π–ª)

**–£–¥–∞–ª–∏—Ç—å:**
```bash
rm FIXED.md
rm –í–°–Å_–ò–°–ü–†–ê–í–õ–ï–ù–û.md
rm –ò–°–ü–†–ê–í–õ–ï–ù–û_–î–ï–ú–û_–†–ï–ñ–ò–ú.md
rm –ò–°–ü–†–ê–í–õ–ï–ù–û_–û–®–ò–ë–ö–ê_ONVIEWSAVED.md
rm –ò–°–ü–†–ê–í–õ–ï–ù–û_–°–û–•–†–ê–ù–Å–ù–ù–´–ï.md
```

**–°–æ–∑–¥–∞—Ç—å:** `docs/CHANGELOG.md`
```markdown
# –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

## [Unreleased]

## [2.0.0] - 2025-11-10
### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- UTF-8 –∏ –∫–∏—Ä–∏–ª–ª–∏—Ü–∞
- Rate Limiting
- XSS –∑–∞—â–∏—Ç–∞

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ
- –û—à–∏–±–∫–∞ onViewSaved
- –î–µ–º–æ-—Ä–µ–∂–∏–º
- –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
```

**–≠–∫–æ–Ω–æ–º–∏—è:** 18+ —Ñ–∞–π–ª–æ–≤ ‚Üí 4 —Ñ–∞–π–ª–∞

---

### –ó–∞–¥–∞—á–∞ 1.2: Notification wrapper (30 –º–∏–Ω—É—Ç)

**–°–æ–∑–¥–∞—Ç—å:** `lib/notifications.ts`

```typescript
import { toast } from 'sonner@2.0.3';
import { MESSAGES, UI } from './constants';

/**
 * –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π API –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
 * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏–∑ MESSAGES
 */

export const notify = {
  // Success notifications
  fileUploaded: () => {
    toast.success(MESSAGES.SUCCESS.FILE_UPLOADED, {
      duration: UI.TOAST_DURATION,
    });
  },

  scriptSaved: (remainingSlots: number) => {
    const message = remainingSlots > 0
      ? `${MESSAGES.SUCCESS.SCRIPT_SAVED}! –û—Å—Ç–∞–ª–æ—Å—å –º–µ—Å—Ç: ${remainingSlots}. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∫–ª–∞–¥–∫—É "–°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ" –≤–Ω–∏–∑—É.`
      : `${MESSAGES.SUCCESS.SCRIPT_SAVED}! –õ–∏–º–∏—Ç –¥–æ—Å—Ç–∏–≥–Ω—É—Ç.`;
    
    toast.success(message, {
      duration: UI.TOAST_DURATION + 1000, // –ß—É—Ç—å –¥–æ–ª—å—à–µ
    });
  },

  scriptDeleted: () => {
    toast.success(MESSAGES.SUCCESS.SCRIPT_DELETED);
  },

  allScriptsDeleted: () => {
    toast.success(MESSAGES.SUCCESS.ALL_DELETED);
  },

  copied: (what: string = '–°–æ–¥–µ—Ä–∂–∏–º–æ–µ') => {
    toast.success(`${what} ${MESSAGES.SUCCESS.COPIED.toLowerCase()}`);
  },

  // Error notifications
  noFile: () => {
    toast.error(MESSAGES.ERRORS.NO_FILE);
  },

  invalidFormat: () => {
    toast.error(MESSAGES.ERRORS.INVALID_FORMAT);
  },

  fileTooLarge: () => {
    toast.error(MESSAGES.ERRORS.FILE_TOO_LARGE);
  },

  validationError: (message?: string) => {
    toast.error(message || MESSAGES.ERRORS.UNKNOWN_ERROR);
  },

  deleteError: (what: string = '—Å—Ü–µ–Ω–∞—Ä–∏–π') => {
    toast.error(`–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å ${what}`);
  },

  saveError: (message?: string) => {
    toast.error(message || '–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å');
  },

  // Info notifications
  demoMode: () => {
    toast.info('üé≠ ' + MESSAGES.INFO.DEMO_MODE, {
      duration: 5000,
    });
  },

  rateLimitExceeded: (message: string) => {
    toast.error(message, {
      duration: 6000,
    });
  },

  // Generic notifications
  error: (message: string) => {
    toast.error(message);
  },

  success: (message: string) => {
    toast.success(message);
  },

  info: (message: string) => {
    toast.info(message);
  },
};
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ App.tsx:**

```typescript
// ‚ùå –ë–´–õ–û:
if (!uploadedFile) {
  toast.error('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∏–¥–µ–æ');
  return;
}

// ‚úÖ –°–¢–ê–õ–û:
import { notify } from './lib/notifications';

if (!uploadedFile) {
  notify.noFile();
  return;
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ ResultsPage.tsx:**

```typescript
// ‚ùå –ë–´–õ–û:
const handleCopy = (text: string, section: string) => {
  navigator.clipboard.writeText(text);
  setCopiedSection(section);
  toast.success('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
  setTimeout(() => setCopiedSection(null), 2000);
};

// ‚úÖ –°–¢–ê–õ–û:
import { notify } from '../lib/notifications';
import { copyToClipboard } from '../lib/clipboard';

const handleCopy = async (text: string, section: string) => {
  const success = await copyToClipboard(text);
  if (success) {
    setCopiedSection(section);
    setTimeout(() => setCopiedSection(null), 2000);
  }
};
```

**–≠–∫–æ–Ω–æ–º–∏—è:** ~30 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞, —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π

---

### –ó–∞–¥–∞—á–∞ 1.3: Clipboard utils (15 –º–∏–Ω—É—Ç)

**–°–æ–∑–¥–∞—Ç—å:** `lib/clipboard.ts`

```typescript
import { notify } from './notifications';

/**
 * –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±—É—Ñ–µ—Ä–æ–º –æ–±–º–µ–Ω–∞
 */

/**
 * –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
 */
export async function copyToClipboard(
  text: string,
  notifyUser: boolean = true
): Promise<boolean> {
  try {
    await navigator.clipboard.writeText(text);
    
    if (notifyUser) {
      notify.copied('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ');
    }
    
    return true;
  } catch (error) {
    console.error('Failed to copy:', error);
    
    // Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
    try {
      const textarea = document.createElement('textarea');
      textarea.value = text;
      textarea.style.position = 'fixed';
      textarea.style.opacity = '0';
      document.body.appendChild(textarea);
      textarea.select();
      const success = document.execCommand('copy');
      document.body.removeChild(textarea);
      
      if (success && notifyUser) {
        notify.copied('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ');
      }
      
      return success;
    } catch (fallbackError) {
      if (notifyUser) {
        notify.error('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å');
      }
      return false;
    }
  }
}

/**
 * –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –¥–æ—Å—Ç—É–ø–µ–Ω –ª–∏ Clipboard API
 */
export function isClipboardAvailable(): boolean {
  return typeof navigator?.clipboard?.writeText === 'function';
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```typescript
// ‚ùå –ë–´–õ–û:
navigator.clipboard.writeText(text);
toast.success('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!');

// ‚úÖ –°–¢–ê–õ–û:
import { copyToClipboard } from '../lib/clipboard';
await copyToClipboard(text);
```

---

## üé® –§–ê–ó–ê 2: Styled –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (2-3 —á–∞—Å–∞)

### –ó–∞–¥–∞—á–∞ 2.1: Styled Accordion (1 —á–∞—Å)

**–°–æ–∑–¥–∞—Ç—å:** `components/ui/styled-accordion.tsx`

```typescript
import { AccordionItem, AccordionTrigger, AccordionContent } from './accordion';
import { ReactNode } from 'react';
import { cn } from './utils';

interface StyledAccordionItemProps {
  value: string;
  children: ReactNode;
  className?: string;
}

/**
 * AccordionItem —Å–æ —Å—Ç–∏–ª—è–º–∏ Apple HIG
 */
export function StyledAccordionItem({ 
  value, 
  children, 
  className 
}: StyledAccordionItemProps) {
  return (
    <AccordionItem
      value={value}
      className={cn(
        "bg-white rounded-xl border-0 shadow-sm overflow-hidden",
        className
      )}
    >
      {children}
    </AccordionItem>
  );
}

interface StyledAccordionTriggerProps {
  children: ReactNode;
  className?: string;
}

/**
 * AccordionTrigger —Å–æ —Å—Ç–∏–ª—è–º–∏ Apple HIG
 */
export function StyledAccordionTrigger({ 
  children, 
  className 
}: StyledAccordionTriggerProps) {
  return (
    <AccordionTrigger
      className={cn(
        "px-6 py-4 hover:no-underline hover:bg-gray-50",
        className
      )}
    >
      {children}
    </AccordionTrigger>
  );
}

/**
 * –ü–æ–ª–Ω—ã–π Accordion —Å –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ —Å—Ç–∏–ª—è–º–∏
 */
interface StyledAccordionProps {
  items: Array<{
    value: string;
    trigger: ReactNode;
    content: ReactNode;
  }>;
  type?: 'single' | 'multiple';
  className?: string;
}

export function StyledAccordion({ 
  items, 
  type = 'single',
  className 
}: StyledAccordionProps) {
  return (
    <Accordion type={type} collapsible className={cn("space-y-3", className)}>
      {items.map((item) => (
        <StyledAccordionItem key={item.value} value={item.value}>
          <StyledAccordionTrigger>
            {item.trigger}
          </StyledAccordionTrigger>
          <AccordionContent className="px-6 py-4">
            {item.content}
          </AccordionContent>
        </StyledAccordionItem>
      ))}
    </Accordion>
  );
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ ResultsPage.tsx:**

```typescript
// ‚ùå –ë–´–õ–û (140 —Å—Ç—Ä–æ–∫–∞):
<AccordionItem value="original" className="bg-white rounded-2xl shadow-sm border-0 overflow-hidden">
  <AccordionTrigger className="px-4 md:px-6 py-4 hover:no-underline hover:bg-gray-50">
    <div className="flex items-center gap-3">
      <FileText className="w-5 h-5 text-purple-600" />
      <span>–¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è –∏ –ø–µ—Ä–µ–≤–æ–¥</span>
    </div>
  </AccordionTrigger>
  <AccordionContent>
    {/* ... */}
  </AccordionContent>
</AccordionItem>

// ‚úÖ –°–¢–ê–õ–û:
import { StyledAccordionItem, StyledAccordionTrigger } from './ui/styled-accordion';

<StyledAccordionItem value="original">
  <StyledAccordionTrigger>
    <div className="flex items-center gap-3">
      <FileText className="w-5 h-5 text-purple-600" />
      <span>–¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è –∏ –ø–µ—Ä–µ–≤–æ–¥</span>
    </div>
  </StyledAccordionTrigger>
  <AccordionContent>
    {/* ... */}
  </AccordionContent>
</StyledAccordionItem>
```

**–≠–∫–æ–Ω–æ–º–∏—è:** ~40 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞, –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Å—Ç–∏–ª–µ–π

---

### –ó–∞–¥–∞—á–∞ 2.2: Gradient Icon Box (30 –º–∏–Ω—É—Ç)

**–°–æ–∑–¥–∞—Ç—å:** `components/ui/gradient-icon-box.tsx`

```typescript
import { ReactNode } from 'react';
import { cn } from './utils';

type GradientColor = 'purple' | 'green' | 'blue' | 'pink';
type Size = 'sm' | 'md' | 'lg' | 'xl';

interface GradientIconBoxProps {
  children: ReactNode;
  color?: GradientColor;
  size?: Size;
  className?: string;
  animate?: boolean;
}

const gradients: Record<GradientColor, string> = {
  purple: 'from-purple-500 to-blue-500',
  green: 'from-green-500 to-emerald-500',
  blue: 'from-blue-500 to-cyan-500',
  pink: 'from-pink-500 to-purple-500',
};

const sizes: Record<Size, string> = {
  sm: 'w-10 h-10',
  md: 'w-12 h-12',
  lg: 'w-14 h-14',
  xl: 'w-16 h-16',
};

/**
 * –ö—Ä–∞—Å–∏–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∏–∫–æ–Ω–æ–∫
 */
export function GradientIconBox({
  children,
  color = 'purple',
  size = 'md',
  className,
  animate = false,
}: GradientIconBoxProps) {
  return (
    <div
      className={cn(
        'bg-gradient-to-br rounded-2xl flex items-center justify-center shadow-lg',
        gradients[color],
        sizes[size],
        animate && 'transition-transform hover:scale-110',
        className
      )}
    >
      {children}
    </div>
  );
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```typescript
// ‚ùå –ë–´–õ–û:
<div className="w-12 h-12 md:w-14 md:h-14 bg-gradient-to-br from-green-500 to-emerald-500 rounded-xl flex items-center justify-center shadow-lg">
  <CheckCircle2 className="w-6 h-6 md:w-7 md:h-7 text-white" />
</div>

// ‚úÖ –°–¢–ê–õ–û:
import { GradientIconBox } from './ui/gradient-icon-box';

<GradientIconBox color="green" size="lg" animate>
  <CheckCircle2 className="w-6 md:w-7 text-white" />
</GradientIconBox>
```

---

### –ó–∞–¥–∞—á–∞ 2.3: Motion wrappers (1 —á–∞—Å)

**–°–æ–∑–¥–∞—Ç—å:** `components/ui/animated.tsx`

```typescript
import { motion, MotionProps } from 'motion/react';
import { ReactNode } from 'react';
import { ANIMATIONS } from '../../lib/constants';

interface AnimatedProps {
  children: ReactNode;
  delay?: number;
  className?: string;
}

/**
 * Fade In –∞–Ω–∏–º–∞—Ü–∏—è
 */
export function FadeIn({ children, delay = 0, className }: AnimatedProps) {
  return (
    <motion.div
      {...ANIMATIONS.FADE_IN}
      transition={{ duration: 0.6, delay }}
      className={className}
    >
      {children}
    </motion.div>
  );
}

/**
 * Slide In –∞–Ω–∏–º–∞—Ü–∏—è
 */
export function SlideIn({ children, delay = 0, className }: AnimatedProps) {
  return (
    <motion.div
      {...ANIMATIONS.SLIDE_IN}
      transition={{ duration: 0.6, delay }}
      className={className}
    >
      {children}
    </motion.div>
  );
}

/**
 * Scale –∞–Ω–∏–º–∞—Ü–∏—è
 */
export function ScaleIn({ children, delay = 0, className }: AnimatedProps) {
  return (
    <motion.div
      {...ANIMATIONS.SCALE}
      transition={{ duration: 0.6, delay }}
      className={className}
    >
      {children}
    </motion.div>
  );
}

/**
 * Spring –∞–Ω–∏–º–∞—Ü–∏—è
 */
export function Spring({ children, delay = 0, className }: AnimatedProps) {
  return (
    <motion.div
      initial={{ scale: 0 }}
      animate={{ scale: 1 }}
      transition={{ delay, ...ANIMATIONS.SPRING }}
      className={className}
    >
      {children}
    </motion.div>
  );
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```typescript
// ‚ùå –ë–´–õ–û:
<motion.div
  initial={{ opacity: 0, y: 20 }}
  animate={{ opacity: 1, y: 0 }}
  transition={{ delay: 0.4 }}
>
  <Content />
</motion.div>

// ‚úÖ –°–¢–ê–õ–û:
import { FadeIn } from './ui/animated';

<FadeIn delay={0.4}>
  <Content />
</FadeIn>
```

---

## üõ†Ô∏è –§–ê–ó–ê 3: –£—Ç–∏–ª–∏—Ç—ã (1-2 —á–∞—Å–∞)

### –ó–∞–¥–∞—á–∞ 3.1: –§–æ—Ä–º–∞—Ç—Ç–µ—Ä—ã (30 –º–∏–Ω—É—Ç)

**–°–æ–∑–¥–∞—Ç—å:** `lib/formatters.ts`

```typescript
import type { VideoAnalysisResult } from './api';

/**
 * –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
 */

/**
 * –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
 */
export function formatScriptForDisplay(
  script: VideoAnalysisResult['script']
): string {
  return script
    .map(
      (scene) =>
        `[${scene.time}] ${scene.visual}\n"${scene.text}"\n(${scene.note})\n`
    )
    .join('\n');
}

/**
 * –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
 */
export function formatScriptForCopy(
  script: VideoAnalysisResult['script'],
  includeIndex: boolean = true
): string {
  return script
    .map(
      (scene, index) =>
        `${includeIndex ? `${index + 1}. ` : ''}${scene.time}\n` +
        `–í–∏–∑—É–∞–ª: ${scene.visual}\n` +
        `–¢–µ–∫—Å—Ç: ${scene.text}\n` +
        `–ó–∞–º–µ—Ç–∫–∞: ${scene.note}\n`
    )
    .join('\n');
}

/**
 * –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
 */
export function formatFullAnalysisForCopy(
  result: VideoAnalysisResult
): string {
  const scriptText = formatScriptForCopy(result.script);
  const recommendations = result.recommendations
    .map((r) => `${r.category}: ${r.text}`)
    .join('\n');

  return (
    `üìù ${result.title}\n\n` +
    `üé¨ –°–¶–ï–ù–ê–†–ò–ô:\n\n${scriptText}\n\n` +
    `üí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:\n${recommendations}`
  );
}

/**
 * –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞—Ç—É –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
 */
export function formatDate(isoDate: string): string {
  const date = new Date(isoDate);
  return date.toLocaleDateString('ru-RU', {
    day: 'numeric',
    month: 'long',
    year: 'numeric',
    hour: '2-digit',
    minute: '2-digit',
  });
}

/**
 * –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è
 */
export function formatRelativeTime(isoDate: string): string {
  const date = new Date(isoDate);
  const now = new Date();
  const diffMs = now.getTime() - date.getTime();
  const diffMins = Math.floor(diffMs / 60000);
  const diffHours = Math.floor(diffMins / 60);
  const diffDays = Math.floor(diffHours / 24);

  if (diffMins < 1) return '—Ç–æ–ª—å–∫–æ —á—Ç–æ';
  if (diffMins < 60) return `${diffMins} –º–∏–Ω –Ω–∞–∑–∞–¥`;
  if (diffHours < 24) return `${diffHours} —á –Ω–∞–∑–∞–¥`;
  if (diffDays < 7) return `${diffDays} –¥–Ω –Ω–∞–∑–∞–¥`;
  
  return formatDate(isoDate);
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```typescript
// ‚ùå –ë–´–õ–û:
const formatScript = () => {
  return analysisResult.script.map(scene => 
    `[${scene.time}] ${scene.visual}\n"${scene.text}"\n(${scene.note})\n`
  ).join('\n');
};

// ‚úÖ –°–¢–ê–õ–û:
import { formatScriptForDisplay } from '../lib/formatters';

const scriptText = formatScriptForDisplay(analysisResult.script);
```

---

### –ó–∞–¥–∞—á–∞ 3.2: Error helpers (20 –º–∏–Ω—É—Ç)

**–î–æ–±–∞–≤–∏—Ç—å –≤:** `lib/utils.ts`

```typescript
import { notify } from './notifications';

/**
 * –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
 */
export function handleOperationResult<T>(
  result: { success: boolean; error?: string; data?: T },
  successMessage: string,
  errorPrefix: string = '–û—à–∏–±–∫–∞'
): T | null {
  if (result.success) {
    notify.success(successMessage);
    return (result.data ?? null) as T | null;
  } else {
    notify.error(result.error || `${errorPrefix}: –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞`);
    return null;
  }
}

/**
 * –û–±—Ä–∞–±–æ—Ç–∞—Ç—å async –æ–ø–µ—Ä–∞—Ü–∏—é —Å try/catch –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
 */
export async function handleAsyncOperation<T>(
  operation: () => Promise<T>,
  successMessage: string,
  errorMessage: string = '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞'
): Promise<T | null> {
  try {
    const result = await operation();
    notify.success(successMessage);
    return result;
  } catch (error) {
    console.error('Operation failed:', error);
    notify.error(errorMessage);
    return null;
  }
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```typescript
// ‚ùå –ë–´–õ–û:
const handleSaveScript = () => {
  const result = saveScript(analysisResult);
  if (result.success) {
    setIsSaved(true);
    triggerConfetti();
    const remaining = getRemainingSlots();
    toast.success(`–°—Ü–µ–Ω–∞—Ä–∏–π —Å–æ—Ö—Ä–∞–Ω—ë–Ω! –û—Å—Ç–∞–ª–æ—Å—å: ${remaining}`);
  } else {
    toast.error(result.error || '–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å');
  }
};

// ‚úÖ –°–¢–ê–õ–û:
import { handleOperationResult } from '../lib/utils';

const handleSaveScript = () => {
  const saved = handleOperationResult(
    saveScript(analysisResult),
    `–°—Ü–µ–Ω–∞—Ä–∏–π —Å–æ—Ö—Ä–∞–Ω—ë–Ω! –û—Å—Ç–∞–ª–æ—Å—å: ${getRemainingSlots()}`,
    '–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å'
  );
  
  if (saved) {
    setIsSaved(true);
    triggerConfetti();
  }
};
```

---

## üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –†–ï–§–ê–ö–¢–û–†–ò–ù–ì–ê

### –î–æ:
- –°—Ç—Ä–æ–∫ –∫–æ–¥–∞: ~3500
- –§–∞–π–ª–æ–≤: ~120
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è: –≤—ã—Å–æ–∫–æ–µ
- DRY Score: 4/10

### –ü–æ—Å–ª–µ:
- –°—Ç—Ä–æ–∫ –∫–æ–¥–∞: ~3300 (-200)
- –§–∞–π–ª–æ–≤: ~90 (-30)
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è: –Ω–∏–∑–∫–æ–µ
- DRY Score: 8/10

---

## ‚úÖ –ß–ï–ö–õ–ò–°–¢ –í–´–ü–û–õ–ù–ï–ù–ò–Ø

### –§–∞–∑–∞ 1: –ë—ã—Å—Ç—Ä—ã–µ –ø–æ–±–µ–¥—ã
- [ ] –û–±—ä–µ–¥–∏–Ω–∏—Ç—å —Ñ–∞–π–ª—ã –æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (9 ‚Üí 2)
- [ ] –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (4 ‚Üí 1)
- [ ] –û–±—ä–µ–¥–∏–Ω–∏—Ç—å —á–µ–∫–ª–∏—Å—Ç—ã (4 ‚Üí 1)
- [ ] –°–æ–∑–¥–∞—Ç—å CHANGELOG (5+ ‚Üí 1)
- [ ] –°–æ–∑–¥–∞—Ç—å lib/notifications.ts
- [ ] –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ toast.success/error
- [ ] –°–æ–∑–¥–∞—Ç—å lib/clipboard.ts
- [ ] –ó–∞–º–µ–Ω–∏—Ç—å navigator.clipboard

### –§–∞–∑–∞ 2: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- [ ] –°–æ–∑–¥–∞—Ç—å ui/styled-accordion.tsx
- [ ] –ó–∞–º–µ–Ω–∏—Ç—å –≤–æ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö (18 –º–µ—Å—Ç)
- [ ] –°–æ–∑–¥–∞—Ç—å ui/gradient-icon-box.tsx
- [ ] –ó–∞–º–µ–Ω–∏—Ç—å –≤–æ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö (5+ –º–µ—Å—Ç)
- [ ] –°–æ–∑–¥–∞—Ç—å ui/animated.tsx
- [ ] –ó–∞–º–µ–Ω–∏—Ç—å motion.div (10+ –º–µ—Å—Ç)

### –§–∞–∑–∞ 3: –£—Ç–∏–ª–∏—Ç—ã
- [ ] –°–æ–∑–¥–∞—Ç—å lib/formatters.ts
- [ ] –ó–∞–º–µ–Ω–∏—Ç—å formatScript —Ñ—É–Ω–∫—Ü–∏–∏
- [ ] –î–æ–±–∞–≤–∏—Ç—å error helpers –≤ utils.ts
- [ ] –ó–∞–º–µ–Ω–∏—Ç—å if/else –ø–∞—Ç—Ç–µ—Ä–Ω—ã

### –§–∞–∑–∞ 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∏–ª–∏

---

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 8-10 —á–∞—Å–æ–≤  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π üî¥  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è  
**–†–∏—Å–∫:** –ù–∏–∑–∫–∏–π (–Ω–µ –º–µ–Ω—è–µ–º –ª–æ–≥–∏–∫—É)
